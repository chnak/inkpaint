{"version":3,"sources":["../../src/display/TransformStatic.js"],"names":["TransformStatic","TransformBase","constructor","position","ObservablePoint","onChange","scale","pivot","skew","updateSkew","_rotation","_cx","_sx","_cy","_sy","_localID","_currentLocalID","Math","cos","_y","sin","_x","updateLocalTransform","lt","localTransform","a","b","c","d","tx","ty","_parentID","updateTransform","parentTransform","_worldID","pt","worldTransform","wt","setFromMatrix","matrix","decompose","rotation","value"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEe,MAAMA,eAAN,SAA8BC,sBAA9B,CAA4C;AACzDC,EAAAA,WAAW,GAAG;AACZ;AAEA,SAAKC,QAAL,GAAgB,IAAIC,qBAAJ,CAAoB,KAAKC,QAAzB,EAAmC,IAAnC,EAAyC,CAAzC,EAA4C,CAA5C,CAAhB;AACA,SAAKC,KAAL,GAAa,IAAIF,qBAAJ,CAAoB,KAAKC,QAAzB,EAAmC,IAAnC,EAAyC,CAAzC,EAA4C,CAA5C,CAAb;AACA,SAAKE,KAAL,GAAa,IAAIH,qBAAJ,CAAoB,KAAKC,QAAzB,EAAmC,IAAnC,EAAyC,CAAzC,EAA4C,CAA5C,CAAb;AACA,SAAKG,IAAL,GAAY,IAAIJ,qBAAJ,CAAoB,KAAKK,UAAzB,EAAqC,IAArC,EAA2C,CAA3C,EAA8C,CAA9C,CAAZ;AACA,SAAKC,SAAL,GAAiB,CAAjB;AAEA,SAAKC,GAAL,GAAW,CAAX,CATY,CASE;;AACd,SAAKC,GAAL,GAAW,CAAX,CAVY,CAUE;;AACd,SAAKC,GAAL,GAAW,CAAX,CAXY,CAWE;;AACd,SAAKC,GAAL,GAAW,CAAX,CAZY,CAYE;;AAEd,SAAKC,QAAL,GAAgB,CAAhB;AACA,SAAKC,eAAL,GAAuB,CAAvB;AACD;;AAEDX,EAAAA,QAAQ,GAAG;AACT,SAAKU,QAAL;AACD;;AAEDN,EAAAA,UAAU,GAAG;AACX,SAAKE,GAAL,GAAWM,IAAI,CAACC,GAAL,CAAS,KAAKR,SAAL,GAAiB,KAAKF,IAAL,CAAUW,EAApC,CAAX;AACA,SAAKP,GAAL,GAAWK,IAAI,CAACG,GAAL,CAAS,KAAKV,SAAL,GAAiB,KAAKF,IAAL,CAAUW,EAApC,CAAX;AACA,SAAKN,GAAL,GAAW,CAACI,IAAI,CAACG,GAAL,CAAS,KAAKV,SAAL,GAAiB,KAAKF,IAAL,CAAUa,EAApC,CAAZ,CAHW,CAG0C;;AACrD,SAAKP,GAAL,GAAWG,IAAI,CAACC,GAAL,CAAS,KAAKR,SAAL,GAAiB,KAAKF,IAAL,CAAUa,EAApC,CAAX,CAJW,CAIyC;;AAEpD,SAAKN,QAAL;AACD;;AAEDO,EAAAA,oBAAoB,GAAG;AACrB,QAAMC,EAAE,GAAG,KAAKC,cAAhB;;AAEA,QAAI,KAAKT,QAAL,KAAkB,KAAKC,eAA3B,EAA4C;AAC1C;AACAO,MAAAA,EAAE,CAACE,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKL,KAAL,CAAWe,EAA7B;AACAE,MAAAA,EAAE,CAACG,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKN,KAAL,CAAWe,EAA7B;AACAE,MAAAA,EAAE,CAACI,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKP,KAAL,CAAWa,EAA7B;AACAI,MAAAA,EAAE,CAACK,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKR,KAAL,CAAWa,EAA7B;AAEAI,MAAAA,EAAE,CAACM,EAAH,GAAQ,KAAK1B,QAAL,CAAckB,EAAd,IAAoB,KAAKd,KAAL,CAAWc,EAAX,GAAgBE,EAAE,CAACE,CAAnB,GAAuB,KAAKlB,KAAL,CAAWY,EAAX,GAAgBI,EAAE,CAACI,CAA9D,CAAR;AACAJ,MAAAA,EAAE,CAACO,EAAH,GAAQ,KAAK3B,QAAL,CAAcgB,EAAd,IAAoB,KAAKZ,KAAL,CAAWc,EAAX,GAAgBE,EAAE,CAACG,CAAnB,GAAuB,KAAKnB,KAAL,CAAWY,EAAX,GAAgBI,EAAE,CAACK,CAA9D,CAAR;AACA,WAAKZ,eAAL,GAAuB,KAAKD,QAA5B,CAT0C,CAW1C;;AACA,WAAKgB,SAAL,GAAiB,CAAC,CAAlB;AACD;AACF;;AAEDC,EAAAA,eAAe,CAACC,eAAD,EAAkB;AAC/B,QAAMV,EAAE,GAAG,KAAKC,cAAhB;;AAEA,QAAI,KAAKT,QAAL,KAAkB,KAAKC,eAA3B,EAA4C;AAC1C;AACAO,MAAAA,EAAE,CAACE,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKL,KAAL,CAAWe,EAA7B;AACAE,MAAAA,EAAE,CAACG,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKN,KAAL,CAAWe,EAA7B;AACAE,MAAAA,EAAE,CAACI,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKP,KAAL,CAAWa,EAA7B;AACAI,MAAAA,EAAE,CAACK,CAAH,GAAO,KAAKd,GAAL,GAAW,KAAKR,KAAL,CAAWa,EAA7B;AAEAI,MAAAA,EAAE,CAACM,EAAH,GAAQ,KAAK1B,QAAL,CAAckB,EAAd,IAAoB,KAAKd,KAAL,CAAWc,EAAX,GAAgBE,EAAE,CAACE,CAAnB,GAAuB,KAAKlB,KAAL,CAAWY,EAAX,GAAgBI,EAAE,CAACI,CAA9D,CAAR;AACAJ,MAAAA,EAAE,CAACO,EAAH,GAAQ,KAAK3B,QAAL,CAAcgB,EAAd,IAAoB,KAAKZ,KAAL,CAAWc,EAAX,GAAgBE,EAAE,CAACG,CAAnB,GAAuB,KAAKnB,KAAL,CAAWY,EAAX,GAAgBI,EAAE,CAACK,CAA9D,CAAR;AACA,WAAKZ,eAAL,GAAuB,KAAKD,QAA5B,CAT0C,CAW1C;;AACA,WAAKgB,SAAL,GAAiB,CAAC,CAAlB;AACD;;AAED,QAAI,KAAKA,SAAL,KAAmBE,eAAe,CAACC,QAAvC,EAAiD;AAC/C;AACA,UAAMC,EAAE,GAAGF,eAAe,CAACG,cAA3B;AACA,UAAMC,EAAE,GAAG,KAAKD,cAAhB;AAEAC,MAAAA,EAAE,CAACZ,CAAH,GAAOF,EAAE,CAACE,CAAH,GAAOU,EAAE,CAACV,CAAV,GAAcF,EAAE,CAACG,CAAH,GAAOS,EAAE,CAACR,CAA/B;AACAU,MAAAA,EAAE,CAACX,CAAH,GAAOH,EAAE,CAACE,CAAH,GAAOU,EAAE,CAACT,CAAV,GAAcH,EAAE,CAACG,CAAH,GAAOS,EAAE,CAACP,CAA/B;AACAS,MAAAA,EAAE,CAACV,CAAH,GAAOJ,EAAE,CAACI,CAAH,GAAOQ,EAAE,CAACV,CAAV,GAAcF,EAAE,CAACK,CAAH,GAAOO,EAAE,CAACR,CAA/B;AACAU,MAAAA,EAAE,CAACT,CAAH,GAAOL,EAAE,CAACI,CAAH,GAAOQ,EAAE,CAACT,CAAV,GAAcH,EAAE,CAACK,CAAH,GAAOO,EAAE,CAACP,CAA/B;AACAS,MAAAA,EAAE,CAACR,EAAH,GAAQN,EAAE,CAACM,EAAH,GAAQM,EAAE,CAACV,CAAX,GAAeF,EAAE,CAACO,EAAH,GAAQK,EAAE,CAACR,CAA1B,GAA8BQ,EAAE,CAACN,EAAzC;AACAQ,MAAAA,EAAE,CAACP,EAAH,GAAQP,EAAE,CAACM,EAAH,GAAQM,EAAE,CAACT,CAAX,GAAeH,EAAE,CAACO,EAAH,GAAQK,EAAE,CAACP,CAA1B,GAA8BO,EAAE,CAACL,EAAzC;AAEA,WAAKC,SAAL,GAAiBE,eAAe,CAACC,QAAjC,CAZ+C,CAc/C;;AACA,WAAKA,QAAL;AACD;AACF;;AAEDI,EAAAA,aAAa,CAACC,MAAD,EAAS;AACpBA,IAAAA,MAAM,CAACC,SAAP,CAAiB,IAAjB;AACA,SAAKzB,QAAL;AACD;;AAEW,MAAR0B,QAAQ,GAAG;AACb,WAAO,KAAK/B,SAAZ;AACD;;AAEW,MAAR+B,QAAQ,CAACC,KAAD,EAAQ;AAClB,QAAI,KAAKhC,SAAL,KAAmBgC,KAAvB,EAA8B;AAC5B,WAAKhC,SAAL,GAAiBgC,KAAjB;AACA,WAAKjC,UAAL;AACD;AACF;;AAtGwD","sourcesContent":["import { ObservablePoint } from \"../math\";\nimport TransformBase from \"./TransformBase\";\n\nexport default class TransformStatic extends TransformBase {\n  constructor() {\n    super();\n\n    this.position = new ObservablePoint(this.onChange, this, 0, 0);\n    this.scale = new ObservablePoint(this.onChange, this, 1, 1);\n    this.pivot = new ObservablePoint(this.onChange, this, 0, 0);\n    this.skew = new ObservablePoint(this.updateSkew, this, 0, 0);\n    this._rotation = 0;\n\n    this._cx = 1; // cos rotation + skewY;\n    this._sx = 0; // sin rotation + skewY;\n    this._cy = 0; // cos rotation + Math.PI/2 - skewX;\n    this._sy = 1; // sin rotation + Math.PI/2 - skewX;\n\n    this._localID = 0;\n    this._currentLocalID = 0;\n  }\n\n  onChange() {\n    this._localID++;\n  }\n\n  updateSkew() {\n    this._cx = Math.cos(this._rotation + this.skew._y);\n    this._sx = Math.sin(this._rotation + this.skew._y);\n    this._cy = -Math.sin(this._rotation - this.skew._x); // cos, added PI/2\n    this._sy = Math.cos(this._rotation - this.skew._x); // sin, added PI/2\n\n    this._localID++;\n  }\n\n  updateLocalTransform() {\n    const lt = this.localTransform;\n\n    if (this._localID !== this._currentLocalID) {\n      // get the matrix values of the displayobject based on its transform properties..\n      lt.a = this._cx * this.scale._x;\n      lt.b = this._sx * this.scale._x;\n      lt.c = this._cy * this.scale._y;\n      lt.d = this._sy * this.scale._y;\n\n      lt.tx = this.position._x - (this.pivot._x * lt.a + this.pivot._y * lt.c);\n      lt.ty = this.position._y - (this.pivot._x * lt.b + this.pivot._y * lt.d);\n      this._currentLocalID = this._localID;\n\n      // force an update..\n      this._parentID = -1;\n    }\n  }\n\n  updateTransform(parentTransform) {\n    const lt = this.localTransform;\n\n    if (this._localID !== this._currentLocalID) {\n      // get the matrix values of the displayobject based on its transform properties..\n      lt.a = this._cx * this.scale._x;\n      lt.b = this._sx * this.scale._x;\n      lt.c = this._cy * this.scale._y;\n      lt.d = this._sy * this.scale._y;\n\n      lt.tx = this.position._x - (this.pivot._x * lt.a + this.pivot._y * lt.c);\n      lt.ty = this.position._y - (this.pivot._x * lt.b + this.pivot._y * lt.d);\n      this._currentLocalID = this._localID;\n\n      // force an update..\n      this._parentID = -1;\n    }\n\n    if (this._parentID !== parentTransform._worldID) {\n      // concat the parent matrix with the objects transform.\n      const pt = parentTransform.worldTransform;\n      const wt = this.worldTransform;\n\n      wt.a = lt.a * pt.a + lt.b * pt.c;\n      wt.b = lt.a * pt.b + lt.b * pt.d;\n      wt.c = lt.c * pt.a + lt.d * pt.c;\n      wt.d = lt.c * pt.b + lt.d * pt.d;\n      wt.tx = lt.tx * pt.a + lt.ty * pt.c + pt.tx;\n      wt.ty = lt.tx * pt.b + lt.ty * pt.d + pt.ty;\n\n      this._parentID = parentTransform._worldID;\n\n      // update the id of the transform..\n      this._worldID++;\n    }\n  }\n\n  setFromMatrix(matrix) {\n    matrix.decompose(this);\n    this._localID++;\n  }\n\n  get rotation() {\n    return this._rotation;\n  }\n\n  set rotation(value) {\n    if (this._rotation !== value) {\n      this._rotation = value;\n      this.updateSkew();\n    }\n  }\n}\n"],"file":"TransformStatic.js"}