{"version":3,"sources":["../../src/display/DisplayObject.js"],"names":["DisplayObject","EventEmitter","constructor","TransformClass","settings","TRANSFORM_MODE","STATIC","TransformStatic","Transform","tempDisplayObjectParent","transform","alpha","visible","renderable","parent","worldAlpha","filterArea","filters","_enabledFilters","_bounds","Bounds","_boundsID","_lastBoundsID","_boundsRect","_localBoundsRect","_mask","_blur","_chroma","_motion","_fxaa","maskEnabled","destroyed","id","_tempDisplayObjectParent","updateTransform","updateID","_recursivePostUpdateTransform","getBounds","skipUpdate","rect","calculateBounds","Rectangle","getRectangle","getLocalBounds","transformRef","parentRef","bounds","toGlobal","position","point","displayObjectUpdateTransform","worldTransform","apply","getGlobalPosition","x","y","toLocal","from","applyInverse","copyFromProxy","proxyObj","copyFunc","key","scale","copy","anchor","substitute","index","getChildIndex","removeChild","addChildAt","destroy","renderWebGL","renderer","renderCanvas","setParent","container","addChild","Error","setTransform","scaleX","scaleY","rotation","skewX","skewY","pivotX","pivotY","skew","pivot","attr","attrs","val","getAttr","value","localTransform","worldVisible","item","mask","isMask","hasFilters","length","addFilter","opt","filter","SimpleFilter","push","e","console","error","removeFilter","setMotion","maskSprite","find","DisplacementFilter","map","_texture","setScale","colorMatrix","matrix","_colorMatrix","_colorMatrixAlpha","setColorMatrix","opts","ColorMatrixFilter","Array","isArray","init","undefined","call","chroma","color","similarity","smoothness","saturation","shadowness","rgbColor","isNaN","ChromaFilter","blur","BlurFilter","fxaa","FXAAFilter","removeAllListeners","_currentBounds","interactive","interactiveChildren","prototype"],"mappings":"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","sourcesContent":["import EventEmitter from \"eventemitter3\";\nimport { TRANSFORM_MODE } from \"../const\";\nimport Bounds from \"./Bounds\";\nimport settings from \"../settings\";\nimport Transform from \"./Transform\";\nimport { str2rgb, uuidvx } from \"../utils\";\nimport { Rectangle, Point } from \"../math\";\nimport TransformStatic from \"./TransformStatic\";\nimport FXAAFilter from \"../filters/fxaa/FXAAFilter\";\nimport BlurFilter from \"../filters/blur/BlurFilter\";\nimport ChromaFilter from \"../filters/chroma/ChromaFilter\";\nimport DisplacementFilter from \"../filters/displacement/DisplacementFilter\";\nimport ColorMatrixFilter from \"../filters/colormatrix/ColorMatrixFilter\";\nimport SimpleFilter from \"../filters/simple/SimpleFilter\";\n\nexport default class DisplayObject extends EventEmitter {\n  constructor() {\n    super();\n\n    const TransformClass =\n      settings.TRANSFORM_MODE === TRANSFORM_MODE.STATIC\n        ? TransformStatic\n        : Transform;\n\n    this.tempDisplayObjectParent = null;\n    this.transform = new TransformClass();\n    this.alpha = 1;\n    this.visible = true;\n    this.renderable = true;\n    this.parent = null;\n    this.worldAlpha = 1;\n    this.filterArea = null;\n\n    this.filters = [];\n    this._enabledFilters = null;\n    this._bounds = new Bounds();\n    this._boundsID = 0;\n    this._lastBoundsID = -1;\n    this._boundsRect = null;\n    this._localBoundsRect = null;\n    this._mask = null;\n    this._blur = 0;\n    this._chroma = null;\n    this._motion = null;\n    this._fxaa = false;\n    this.maskEnabled = true;\n    this.destroyed = false;\n    this.id = uuidvx();\n  }\n\n  get _tempDisplayObjectParent() {\n    if (this.tempDisplayObjectParent === null) {\n      this.tempDisplayObjectParent = new DisplayObject();\n    }\n    return this.tempDisplayObjectParent;\n  }\n\n  updateTransform() {\n    this.transform.updateTransform(this.parent.transform);\n    this.worldAlpha = this.alpha * this.parent.worldAlpha;\n    this._bounds.updateID++;\n  }\n\n  _recursivePostUpdateTransform() {\n    if (this.parent) {\n      this.parent._recursivePostUpdateTransform();\n      this.transform.updateTransform(this.parent.transform);\n    } else {\n      this.transform.updateTransform(this._tempDisplayObjectParent.transform);\n    }\n  }\n\n  getBounds(skipUpdate, rect) {\n    if (!skipUpdate) {\n      if (!this.parent) {\n        this.parent = this._tempDisplayObjectParent;\n        this.updateTransform();\n        this.parent = null;\n      } else {\n        this._recursivePostUpdateTransform();\n        this.updateTransform();\n      }\n    }\n\n    if (this._boundsID !== this._lastBoundsID && this.maskEnabled) {\n      this.calculateBounds();\n    }\n\n    if (!rect) {\n      if (!this._boundsRect) {\n        this._boundsRect = new Rectangle();\n      }\n      rect = this._boundsRect;\n    }\n\n    return this._bounds.getRectangle(rect);\n  }\n\n  getLocalBounds(rect) {\n    const transformRef = this.transform;\n    const parentRef = this.parent;\n    this.parent = null;\n    this.transform = this._tempDisplayObjectParent.transform;\n\n    if (!rect) {\n      if (!this._localBoundsRect) {\n        this._localBoundsRect = new Rectangle();\n      }\n      rect = this._localBoundsRect;\n    }\n\n    const bounds = this.getBounds(false, rect);\n    this.parent = parentRef;\n    this.transform = transformRef;\n    return bounds;\n  }\n\n  toGlobal(position, point, skipUpdate = false) {\n    if (!skipUpdate) {\n      this._recursivePostUpdateTransform();\n\n      if (!this.parent) {\n        this.parent = this._tempDisplayObjectParent;\n        this.displayObjectUpdateTransform();\n        this.parent = null;\n      } else {\n        this.displayObjectUpdateTransform();\n      }\n    }\n\n    return this.worldTransform.apply(position, point);\n  }\n\n  getGlobalPosition(point, skipUpdate = false) {\n    if (this.parent) {\n      this.parent.toGlobal(this.position, point, skipUpdate);\n    } else {\n      point.x = this.position.x;\n      point.y = this.position.y;\n    }\n    return point;\n  }\n\n  toLocal(position, from, point, skipUpdate) {\n    if (from) {\n      position = from.toGlobal(position, point, skipUpdate);\n    }\n\n    if (!skipUpdate) {\n      this._recursivePostUpdateTransform();\n\n      if (!this.parent) {\n        this.parent = this._tempDisplayObjectParent;\n        this.displayObjectUpdateTransform();\n        this.parent = null;\n      } else {\n        this.displayObjectUpdateTransform();\n      }\n    }\n\n    return this.worldTransform.applyInverse(position, point);\n  }\n\n  copyFromProxy(proxyObj) {\n    const copyFunc = key => {\n      if (proxyObj[key] !== null) {\n        this[key] = proxyObj[key];\n      }\n    };\n\n    copyFunc(\"x\");\n    copyFunc(\"y\");\n    copyFunc(\"text\");\n    copyFunc(\"style\");\n    copyFunc(\"width\");\n    copyFunc(\"height\");\n    copyFunc(\"alpha\");\n    copyFunc(\"rotation\");\n    copyFunc(\"blendMode\");\n    this.scale.copy(proxyObj.scale);\n    this.anchor.copy(proxyObj.anchor);\n  }\n\n  substitute(proxyObj) {\n    this.copyFromProxy(proxyObj);\n    const { parent } = proxyObj;\n\n    if (parent) {\n      const index = parent.getChildIndex(proxyObj);\n      parent.removeChild(proxyObj);\n      parent.addChildAt(this, index);\n    }\n\n    proxyObj.destroy();\n    proxyObj = null;\n  }\n\n  renderWebGL(renderer) {\n    // OVERWRITE;\n  }\n\n  renderCanvas(renderer) {\n    // OVERWRITE;\n  }\n\n  setParent(container) {\n    if (!container || !container.addChild) {\n      throw new Error(\"setParent: Argument must be a Container\");\n    }\n    container.addChild(this);\n    return container;\n  }\n\n  setTransform(\n    x = 0,\n    y = 0,\n    scaleX = 1,\n    scaleY = 1,\n    rotation = 0,\n    skewX = 0,\n    skewY = 0,\n    pivotX = 0,\n    pivotY = 0\n  ) {\n    this.position.x = x;\n    this.position.y = y;\n    this.scale.x = !scaleX ? 1 : scaleX;\n    this.scale.y = !scaleY ? 1 : scaleY;\n    this.rotation = rotation;\n    this.skew.x = skewX;\n    this.skew.y = skewY;\n    this.pivot.x = pivotX;\n    this.pivot.y = pivotY;\n\n    return this;\n  }\n\n  attr(attrs) {\n    for (let key in attrs) {\n      const val = attrs[key];\n\n      switch (key) {\n        case \"scale\":\n          this.scale.x = val;\n          this.scale.y = val;\n          break;\n\n        case \"skew\":\n          this.skew.x = val;\n          this.skew.y = val;\n          break;\n\n        case \"rotate\":\n          this.rotation = val;\n          break;\n\n        default:\n          this[key] = val;\n      }\n    }\n  }\n\n  getAttr(key) {\n    let attr;\n    switch (key) {\n      case \"scale\":\n        attr = this.scale.x;\n        break;\n\n      case \"rotate\":\n        attr = this.rotation;\n        break;\n\n      default:\n        attr = this[key];\n    }\n\n    return attr;\n  }\n\n  get x() {\n    return this.position.x;\n  }\n\n  set x(value) {\n    this.transform.position.x = value;\n  }\n\n  get y() {\n    return this.position.y;\n  }\n\n  set y(value) {\n    this.transform.position.y = value;\n  }\n\n  get worldTransform() {\n    return this.transform.worldTransform;\n  }\n\n  get localTransform() {\n    return this.transform.localTransform;\n  }\n\n  get position() {\n    return this.transform.position;\n  }\n\n  set position(value) {\n    this.transform.position.copy(value);\n  }\n\n  get scale() {\n    return this.transform.scale;\n  }\n\n  set scale(value) {\n    this.transform.scale.copy(value);\n  }\n\n  get pivot() {\n    return this.transform.pivot;\n  }\n\n  set pivot(value) {\n    this.transform.pivot.copy(value);\n  }\n\n  get skew() {\n    return this.transform.skew;\n  }\n\n  set skew(value) {\n    this.transform.skew.copy(value);\n  }\n\n  get rotation() {\n    return this.transform.rotation;\n  }\n\n  set rotation(value) {\n    this.transform.rotation = value;\n  }\n\n  get worldVisible() {\n    let item = this;\n\n    do {\n      if (!item.visible) {\n        return false;\n      }\n\n      item = item.parent;\n    } while (item);\n\n    return true;\n  }\n\n  get mask() {\n    return this._mask;\n  }\n\n  set mask(value) {\n    if (this._mask) {\n      this._mask.renderable = true;\n      this._mask.isMask = false;\n    }\n\n    this._mask = value;\n\n    if (this._mask) {\n      this._mask.renderable = false;\n      this._mask.isMask = true;\n    }\n  }\n\n  hasFilters() {\n    if (this.filters && this.filters.length) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  addFilter(opt) {\n    try {\n      const filter = new SimpleFilter(opt);\n      this.filters.push(filter);\n      return filter;\n    } catch (e) {\n      console.error(e);\n      return;\n    }\n  }\n\n  removeFilter(filter) {\n    this.filters = this.filters.filter(x => x != filter);\n  }\n\n  setMotion(maskSprite, scale) {\n    let filter = this.filters.find(x => x instanceof DisplacementFilter);\n    if (!maskSprite) {\n      // remove filter\n      if (filter) this.filters = this.filters.filter(x => x != filter);\n      return;\n    }\n\n    if (filter) {\n      filter.maskSprite = maskSprite;\n      filter.map = maskSprite._texture;\n      filter.setScale(scale, scale);\n    } else {\n      filter = new DisplacementFilter(maskSprite, scale);\n      this.filters.push(filter);\n    }\n    return filter;\n  }\n\n  get colorMatrix() {\n    return { matrix: this._colorMatrix, alpha: this._colorMatrixAlpha };\n  }\n\n  setColorMatrix(opts, alpha=1) {\n    this._colorMatrix = opts;\n    this._colorMatrixAlpha = alpha;\n    let filter = this.filters.find(x => x instanceof ColorMatrixFilter);\n    if (!Array.isArray(opts) || !opts.length) {\n      // remove filter\n      if (filter) this.filters = this.filters.filter(x => x != filter);\n      return;\n    }\n\n    if (filter) {\n      filter.init(); // reset\n    } else {\n      filter = new ColorMatrixFilter();\n      this.filters.push(filter);\n    }\n\n    filter.alpha = alpha;\n    opts.map(opt => {\n      let { key, value } = opt;\n      if (typeof(filter[key]) !== 'function') return;\n      if (value !== undefined && !Array.isArray(value)) value = [value];\n      if (!value) value = [];\n      value.push(true); // set multiply = true\n      filter[key].call(filter, ...value);\n    });\n    return filter;\n  }\n\n  set chroma(opt) {\n    if (opt && typeof(opt) === 'object') {\n      const {color, similarity=0.3, smoothness=0.1, saturation=0.1, shadowness=0.5} = opt;\n      const rgbColor = str2rgb(color, 255);\n      if (isNaN(rgbColor[0]) || isNaN(rgbColor[1]) || isNaN(rgbColor[2])) {\n        this._chroma = null;\n      } else {\n        this._chroma = { color, rgbColor, similarity, smoothness, saturation, shadowness };\n      }\n    } else {\n      this._chroma = null;\n    }\n\n    let filter = this.filters.find(x => x instanceof ChromaFilter);\n    if (!this._chroma) {\n      // remove filter\n      if (filter) this.filters = this.filters.filter(x => x != filter);\n      return;\n    }\n\n    const { rgbColor, similarity, smoothness, saturation, shadowness } = this._chroma;\n    if (filter) {\n      filter.color = rgbColor;\n      filter.similarity = similarity;\n      filter.smoothness = smoothness;\n      filter.saturation = saturation;\n      filter.shadowness = shadowness;\n    } else {\n      filter = new ChromaFilter(rgbColor, similarity, smoothness, saturation, shadowness);\n      this.filters.push(filter);\n    }\n  }\n\n  get chroma() {\n    return this._chroma;\n  }\n\n  set blur(blur = 0) {\n    this._blur = blur;\n    let filter = this.filters.find(x => x instanceof BlurFilter);\n    if (blur <= 0) {\n      // remove filter\n      if (filter) this.filters = this.filters.filter(x => x != filter);\n      return;\n    }\n\n    if (filter) return filter.blur = blur;\n    filter = new BlurFilter(blur);\n    this.filters.push(filter);\n  }\n\n  set fxaa(fxaa) {\n    this._fxaa = fxaa;\n    let filter = this.filters.find(x => x instanceof FXAAFilter);\n    if (fxaa === false) {\n      // remove filter\n      if (filter) this.filters = this.filters.filter(x => x != filter);\n    } else if (!filter) {\n      filter = new FXAAFilter();\n      this.filters.push(filter);\n    }\n  }\n\n  get fxaa() {\n    return this._fxaa;\n  }\n\n  get blur() {\n    return this._blur;\n  }\n\n  destroy() {\n    if (this.destroyed) return;\n\n    this.removeAllListeners();\n    if (this.parent) {\n      this.parent.removeChild(this);\n    }\n\n    this.blur = 0;\n    this.fxaa = false;\n    this.filters = null;\n    this.transform = null;\n    this.parent = null;\n    this._bounds = null;\n    this._currentBounds = null;\n    this._mask = null;\n\n    this.filterArea = null;\n    this.interactive = false;\n    this.interactiveChildren = false;\n    this.destroyed = true;\n  }\n}\n\n// performance increase to avoid using call.. (10x faster)\nDisplayObject.prototype.displayObjectUpdateTransform =\n  DisplayObject.prototype.updateTransform;\n"],"file":"DisplayObject.js"}