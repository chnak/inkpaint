{"version":3,"sources":["../../src/utils/index.js"],"names":["nextUid","removeItems","arr","startIdx","removeCount","length","len","i","uid","uuidvx","replace","c","r","Math","random","v","toString","hex2rgb","hex","out","hex2string","substr","rgb2hex","rgb","rgb2hsl","g","b","max","min","h","s","l","d","getResolutionOfUrl","url","defaultValue","undefined","decomposeDataUri","dataUri","dataUriMatch","DATA_URI","exec","mediaType","toLowerCase","subType","charset","encoding","data","getUrlFileExt","extension","URL_FILE_EXTENSION","getSvgSize","svgString","sizeMatch","SVG_SIZE","size","round","parseFloat","sign","n","premultiplyBlendMode","correctBlendMode","blendMode","premultiplied","premultiplyTint","tint","alpha","R","G","B","premultiplyRgba","premultiply","Float32Array","premultiplyTintToRgba","inherit","ClassA","ClassB","k","prototype"],"mappings":"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","sourcesContent":["import earcut from \"earcut\";\nimport * as mixins from \"./mixin\";\nimport EventEmitter from \"eventemitter3\";\nimport pluginTarget from \"./pluginTarget\";\nimport { DATA_URI, URL_FILE_EXTENSION, SVG_SIZE } from \"../const\";\nimport mapPremultipliedBlendModes from \"./mapPremultipliedBlendModes\";\n\nlet nextUid = 0;\nexport { EventEmitter, pluginTarget, mixins, earcut };\n\nexport function removeItems(arr, startIdx, removeCount) {\n  const length = arr.length;\n  if (startIdx >= length || removeCount <= 0 || startIdx < 0) return;\n\n  removeCount =\n    startIdx + removeCount > length ? length - startIdx : removeCount;\n\n  const len = length - removeCount;\n  for (let i = startIdx; i < len; ++i) arr[i] = arr[i + removeCount];\n  arr.length = len;\n}\n\nexport function uid() {\n  return ++nextUid;\n}\n\nexport function uuidvx() {\n  return \"xxxxxxxx-xxxx-4xxx-yxxx\".replace(/[xy]/g, c => {\n    const r = (Math.random() * 16) | 0;\n    const v = c === \"x\" ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nexport function hex2rgb(hex, out) {\n  out = out || [];\n  out[0] = ((hex >> 16) & 0xff) / 255;\n  out[1] = ((hex >> 8) & 0xff) / 255;\n  out[2] = (hex & 0xff) / 255;\n\n  return out;\n}\n\nexport function hex2string(hex) {\n  hex = hex.toString(16);\n  hex = \"000000\".substr(0, 6 - hex.length) + hex;\n  return `#${hex}`;\n}\n\nexport function rgb2hex(rgb) {\n  return ((rgb[0] * 255) << 16) + ((rgb[1] * 255) << 8) + ((rgb[2] * 255) | 0);\n}\n\nexport function rgb2hsl(r, g, b) {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  let max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n\n  let h,\n    s,\n    l = (max + min) / 2;\n\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    let d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n\n    h /= 6;\n  }\n\n  h *= 360;\n  s *= 100;\n  l *= 100;\n  return [h, s, l];\n}\n\nexport function getResolutionOfUrl(url, defaultValue) {\n  return defaultValue !== undefined ? defaultValue : 1;\n}\n\nexport function decomposeDataUri(dataUri) {\n  const dataUriMatch = DATA_URI.exec(dataUri);\n\n  if (dataUriMatch) {\n    return {\n      mediaType: dataUriMatch[1] ? dataUriMatch[1].toLowerCase() : undefined,\n      subType: dataUriMatch[2] ? dataUriMatch[2].toLowerCase() : undefined,\n      charset: dataUriMatch[3] ? dataUriMatch[3].toLowerCase() : undefined,\n      encoding: dataUriMatch[4] ? dataUriMatch[4].toLowerCase() : undefined,\n      data: dataUriMatch[5]\n    };\n  }\n\n  return undefined;\n}\n\nexport function getUrlFileExt(url) {\n  const extension = URL_FILE_EXTENSION.exec(url);\n  if (extension) return extension[1].toLowerCase();\n  return undefined;\n}\n\nexport function getSvgSize(svgString) {\n  const sizeMatch = SVG_SIZE.exec(svgString);\n  const size = {};\n\n  if (sizeMatch) {\n    size[sizeMatch[1]] = Math.round(parseFloat(sizeMatch[3]));\n    size[sizeMatch[5]] = Math.round(parseFloat(sizeMatch[7]));\n  }\n\n  return size;\n}\n\nexport function sign(n) {\n  if (n === 0) return 0;\n  return n < 0 ? -1 : 1;\n}\n\nexport const premultiplyBlendMode = mapPremultipliedBlendModes();\n\nexport function correctBlendMode(blendMode, premultiplied) {\n  return premultiplyBlendMode[premultiplied ? 1 : 0][blendMode];\n}\n\nexport function premultiplyTint(tint, alpha) {\n  if (alpha === 1.0) {\n    return ((alpha * 255) << 24) + tint;\n  }\n  if (alpha === 0.0) {\n    return 0;\n  }\n  let R = (tint >> 16) & 0xff;\n  let G = (tint >> 8) & 0xff;\n  let B = tint & 0xff;\n\n  R = (R * alpha + 0.5) | 0;\n  G = (G * alpha + 0.5) | 0;\n  B = (B * alpha + 0.5) | 0;\n\n  return ((alpha * 255) << 24) + (R << 16) + (G << 8) + B;\n}\n\nexport function premultiplyRgba(rgb, alpha, out, premultiply) {\n  out = out || new Float32Array(4);\n  if (premultiply || premultiply === undefined) {\n    out[0] = rgb[0] * alpha;\n    out[1] = rgb[1] * alpha;\n    out[2] = rgb[2] * alpha;\n  } else {\n    out[0] = rgb[0];\n    out[1] = rgb[1];\n    out[2] = rgb[2];\n  }\n  out[3] = alpha;\n\n  return out;\n}\n\nexport function premultiplyTintToRgba(tint, alpha, out, premultiply) {\n  out = out || new Float32Array(4);\n  out[0] = ((tint >> 16) & 0xff) / 255.0;\n  out[1] = ((tint >> 8) & 0xff) / 255.0;\n  out[2] = (tint & 0xff) / 255.0;\n  if (premultiply || premultiply === undefined) {\n    out[0] *= alpha;\n    out[1] *= alpha;\n    out[2] *= alpha;\n  }\n  out[3] = alpha;\n\n  return out;\n}\n\nexport function inherit(ClassA, ClassB) {\n  for (const k in ClassB.prototype) {\n    ClassA.prototype[k] = ClassB.prototype[k];\n  }\n}\n"],"file":"index.js"}